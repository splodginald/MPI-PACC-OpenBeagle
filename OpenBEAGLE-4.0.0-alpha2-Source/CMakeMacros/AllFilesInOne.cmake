# Pick all files of a given directory and include them in one .cpp file
macro(AllFilesInOne mfilename mfolder mIgnoreList)
	# Inspired by http://cmake.org/Wiki/CMakeMacroCreateFinalFile
	FILE(REMOVE ${mfolder}/${mfilename})	
	FILE(GLOB TEMP_SRC ${mfolder}/*.cpp)
	FILE(WRITE ${mfolder}/${mfilename} "/* Autogenerated by CMake */\n\n")
	FOREACH (current_FILE ${TEMP_SRC})
		get_filename_component(INCLUDE_NAME ${current_FILE} NAME)
		if(NOT "${mIgnoreList}" MATCHES "null")
			string(REGEX MATCH "${INCLUDE_NAME}" TEST_IGNORE_FILE "${mIgnoreList}")
			if("${TEST_IGNORE_FILE}" STREQUAL "")
				FILE(APPEND ${mfolder}/${mfilename} "#include \"${INCLUDE_NAME}\"\n")
			else("${TEST_IGNORE_FILE}" STREQUAL "")
				message(STATUS "++ ${INCLUDE_NAME} ignored...")
			endif("${TEST_IGNORE_FILE}" STREQUAL "")
		else(NOT "${mIgnoreList}" MATCHES "null")
			FILE(APPEND ${mfolder}/${mfilename} "#include \"${INCLUDE_NAME}\"\n")	
		endif(NOT "${mIgnoreList}" MATCHES "null")
	ENDFOREACH (current_FILE)
	message(STATUS "++ ${mfilename} generated")
endmacro(AllFilesInOne)